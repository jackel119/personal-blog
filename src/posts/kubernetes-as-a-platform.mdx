---
title: "Kubernetes as a Platform"
abstract: Since its inception, Kubernetes has been known and thought of as being a "container orchestration platform". Whilst this is still undoubtedly true, its also not the full picture anymore - Kubernetes can be used for so much more.
date: 2023-04-08T22:30:00+0700
image: /images/kube.webp
---

Since its inception, Kubernetes has been known and thought of as being a "container orchestration platform". Whilst this is still undoubtedly true, its also not the full picture anymore. In fact, I'm going to argue that Kubernetes can now be thought of as a full fat, highly configurable infrastructure platform.

I previously wrote about my experiences diving into Kubernetes for the first time, and the various pros and cons that I encountered. Everything I opinion I had there still holds true, however after some further experimentation and tinkering, I’m even more inclined to go _all in_ on Kube now - not just as a a platform for running applications, but for running _everything_ one would need in a cloud environment.

# Managed Kubernetes Services that give you everything

In the early days of Kubernetes, you had to manage _everything_ yourself. Install `kubeadm` on some baremetal machines or EC2 instances, upgrade control plane nodes, all whilst trying to minimize downtime and interruptions - you get the idea. You needed not just a good understanding of how to use Kubernetes, but also how it worked under the hood in order to administrate and troubleshoot a cluster.

These days, the story is very different. Every major cloud provider now has a "managed" Kubernetes service that handles almost everything for you - from control plane management, worker node provisioning, and version upgrades. 

 If you don't want to go with managed cloud solutions, various alternative "distributions" to `kubeadm` have also cropped up, i.e. Microk8s, k3s, Rancher. These distros have massively simplified installation and management processes if you wanted to run on baremetal or your own self-managed cluster, often allowing you to get a fresh node up and running within a few minutes.

Sure there are still _some_ complicated bits, but its nothing like it used to be - and over time, these complexities are only going to get easier and more abstracted away from end users. I’ll be talking mostly in terms of running inside a managed cloud environment for the rest of the article, but what I say should also apply with on-perm installations with a few extra steps.

## The beginning

First, you need to run a stateless application - say, a super basic “Hello World” HTTP server. You set up a deployment, and a service. You then expose your service via an `Ingress`. Your `Ingress` of course needs a `LoadBalancer` to make it publicly accessible, so you provision your favorite one as well (e.g. NGINX or Traefik). Bam, your cloud provider has detected this and has automatically created a cloud load balancer for your Kubernetes load balancer as well.

Then, you realize you need to attach a custom domain to this endpoint. Traditionally, you’d go into the DNS provider of your choice, and manually attach an A or CNAME record to map the custom domain. But wait! If you have multiple environments/domains, or like to spin new environments up and down on demand, doing this manually isn’t a very scalable method.

There is where our first operator, [External DNS](TODO) comes in. External DNS does the following:

- It can interface with, and control external DNS providers (i.e. Route 53, Godaddy, etc).
- It can watch your internal Kube resources such as ingressses to decide which domains should map to which load balancers, and automatically manage DNS records for you.

## Databases and Storage

Having some stateless containerized applications and automatic DNS management is great, but that’s not going to be enough for your next billion dollar startup. You need persistent storage, such as databases or object storage.

In the early days, the consensus was that you shouldn’t put anything stateful inside Kube at all, because Kubernetes itself doesn’t have any mechanism of persistent storage or backups. For databases, you’d be advised to spin up a cloud managed database like RDS or Cloud SQL, whilst if you wanted object store you’d gear towards S3 or equivalent.

Whilst Kubernetes itself hasn’t necessarily improved its built-in storage management capabilities (well, it doesn’t really have any) - the general knowledge and understanding around handling storage via Kubernetes has improved drastically, and so has the tools and plugins in the ecosystem. Managed Kube services also have improved in terms of automatic provisioning of storage volumes (i.e. EFS/EBS on AWS). [This video](TODO) summarizes pretty well what’s changed in the past few years in this space.

Take PostgreSQL for an example - we can use [Cloud Native PG](TODO) operator to provision high-availability, multi-replica PostgreSQL installation within a cluster. All that needs to be done is to configure what `PersistentVolumeClaim`s/`StorageClass`es to use, and where to back up data. I won’t go into too much specific detail of different operators, but you can also do things with this CloudNativePG that may not be possible out of the box with cloud-managed databases like RDS - for example, setting up an entire replica cluster of any other arbitrarily-hosted Postgres database.

Of course, Postgres isn’t the only option here - whatever your database needs, there’s probably a production-ready operator or Helm chart for it:

- Redis
- MySQL
- MongoDB

Well, what about object storage? Turns out there’s also [`MinIO`](TODO) - an open source, S3-compatible object storage system that - you guessed it - can be self hosted inside Kube.

## Message Queues and Streams

You can also rejoice with your message queue and pub/sub needs, as the following are also available:

- RabbitMQ Cluster Operator
- Kafka

## Honorary mention - data pipeline tools

I’m not a data engineer, so my knowledge on data ETL/pipeline tooling is pretty sparse. That said, a quick google search yielded that the following tools can also be self-hosted in Kubernetes

- Airbyte
- Airflow

## Networking and Service Meshes

In large productionised clusters, you may want to use service meshes to facilitate and monitor service-to-service communication. Fortunately, these tools have been around for years in the Kubernetes world:

- Istio
- Cillium

  

# Operators and CRDs

# Underlying infrastructure agnostic

# What's holding it back?
## Universal CI/CD

## Secrets Management